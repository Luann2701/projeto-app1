<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Pagamento</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body class="fundo-logo">

<div class="card">

    <h1>üí≥ Pagamento</h1>

    <p><strong>Esporte:</strong> {{ esporte }}</p>
    <p><strong>Quadra:</strong> {{ quadra }}</p>
    <p><strong>Data:</strong> {{ data }}</p>
    <p><strong>Hor√°rio:</strong> {{ horario }}</p>

    <h2>Valor: R$ {{ valor }},00</h2>

    <!-- TIMER -->
    <div id="timer" class="timer">
        ‚è≥ Tempo restante: <span id="tempo">10:00</span>
    </div>

    <!-- PIX -->
    <div class="pix-box">
        <img src="{{ url_for('static', filename='qr_pix.png') }}" alt="QR Code Pix">

        <p class="pix-chave">
            CHAVE PIX: <span id="chavePix">59105896000116</span>
            <span class="icone" onclick="copiarPix()">üìã</span>
        </p>

        <p class="pix-destinatario">
            DESTINAT√ÅRIO: Arena Corpo Ativo Ltda
            <span class="icone"></span>
        </p>
    </div>

    <!-- CONFIRMAR PAGAMENTO -->
    <form method="POST" action="/confirmar_pagamento">
        <input type="hidden" name="esporte" value="{{ esporte }}">
        <input type="hidden" name="quadra" value="{{ quadra }}">
        <input type="hidden" name="data" value="{{ data }}">
        <input type="hidden" name="horario" value="{{ horario }}">

        <a href="{{ whatsapp_link }}" target="_blank" class="btn">
            üì≤ Enviar mensagem no WhatsApp
        </a>

        <button type="submit" class="btn">J√° paguei</button>
    </form>

    <!-- CANCELAR -->
    <a href="/horarios/{{ esporte }}/{{ quadra }}/{{ data }}" class="btn secundario">
        Cancelar
    </a>

</div>

<!-- SCRIPT DO TIMER -->
<script>
    let tempo = 600; // 10 minutos

    function atualizarTimer() {
        let minutos = Math.floor(tempo / 60);
        let segundos = tempo % 60;

        minutos = minutos < 10 ? "0" + minutos : minutos;
        segundos = segundos < 10 ? "0" + segundos : segundos;

        document.getElementById("tempo").innerText = minutos + ":" + segundos;

        if (tempo <= 0) {
            alert("‚è∞ Tempo esgotado! A reserva foi cancelada.");
            window.location.href = "/quadras/{{ esporte }}";
        }

        tempo--;
    }

    setInterval(atualizarTimer, 1000);

    // COPIAR CHAVE PIX
    function copiarPix() {
        const texto = document.getElementById("chavePix").innerText;

        navigator.clipboard.writeText(texto).then(() => {
            alert("‚úÖ Chave Pix copiada!");
        }).catch(() => {
            alert("‚ùå N√£o foi poss√≠vel copiar a chave.");
        });
    }
</script>

</body>
</html>
